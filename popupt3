--Epic Fotress

local a,b,c,d,e,f,g,h=UnitDefs or{},table.merge,'epic_ragnarok','epic_calamity','epic_starfall','epic_bastion','epic_sentinel','epic_fortress'


a.epic_fortress=b(a['legapopupdef'],{
  name='Epic Fortress',
  description='Advanced Legion popup defense. Devastating AOE riot protection that never harms allies.',
  buildtime=170000,
  health=30000,
  metalcost=17000,
  energycost=600000,
	footprintx = 3,
	footprintz = 3,
  yardmap = "ooooooooo",
  icontype="legapopupdef",
  customparams={
    i18n_en_humanname='Epic Fortress',
    i18n_en_tooltip='Devastating AOE riot protection that never harms allies.',
    techlevel=3

  },
  weapondefs={
    epic_riot_devastator={
      name='Epic Riot Devastator',
      weapontype='Cannon',
      avoidfriendly=true,
      collidefriendly=false,
      avoidfeature=true,
      damage={
        default=4400
      },
      areaofeffect=260,
      edgeeffectiveness=0.75,
      range=800,
      reloadtime=1.2,
      turret=true,
      weaponvelocity=900,
      explosiongenerator='custom:genericshellexplosion-huge',
      rgbcolor='1.0 0.3 0.5',
      size=10,
      soundhitvolume=22,
      soundstartvolume=18.0,
      impulsefactor=3.2,
      craterboost=0.15,
      cratermult=0.15,
      noselfdamage=true,
      burnblow=true
    },
    epic_minigun={
      accuracy=2,
      areaofeffect=24,
      avoidfeature=false,
      avoidfriendly=false,
      collidefriendly=false,
      burst=10,
      burstrate=0.05,
      burnblow=false,
      craterareaofeffect=0,
      craterboost=0,
      cratermult=0,
      duration=0.05,
      edgeeffectiveness=0.85,
      explosiongenerator="custom:plasmahit-sparkonly",
      fallOffRate=0.15,
      firestarter=5,
      impulsefactor=2.0,
      intensity=1.2,
      name="Epic Rotary Cannons",
      noselfdamage=true,
      ownerExpAccWeight=4.0,
      proximitypriority=1,
      range=750,
      reloadtime=0.3,
      rgbcolor="1 0.4 0.6",
      soundhit="bimpact3",
      soundhitwet="splshbig",
      soundstart="mgun6heavy",
      soundstartvolume=6.5,
      soundtrigger=true,
      sprayangle=450,
      texture1="shot",
      texture2="empty",
      thickness=4.5,
      tolerance=3000,
      turret=true,
      weapontype="LaserCannon",
      weaponvelocity=1300,
      damage={
        default=90,
        vtol=35
      }
    }
  },
  weapons={
    [1]={
      def='epic_riot_devastator',
      onlytargetcategory='SURFACE'
    },
    [2]={
      badtargetcategory='VTOL',
      burstcontrolwhenoutofarc=2,
      def='epic_minigun',
      fastautoretargeting=true,
      onlytargetcategory='SURFACE',
      slaveTo=1
    },
    [3]={
      badtargetcategory='VTOL',
      burstcontrolwhenoutofarc=2,
      def='epic_minigun',
      fastautoretargeting=true,
      onlytargetcategory='SURFACE',
      slaveTo=1
    }
  }
})

local builders={'armaca','armack','armacsub','armacv','coraca','corack','coracsub','coracv','legaca','legack','legacv','legcomt2com'}

for i,j in pairs{'arm','cor','leg'}do
  for k=3,10 do
    table.insert(builders,j..'comlvl'..k)
  end
  table.insert(builders,j..'t3airaide')
end

for i,l in pairs(builders)do 
  if a[l]then 
    local j=string.sub(l,1,3)
    if j=='arm'then 
      table.insert(a[l].buildoptions,c)
      table.insert(a[l].buildoptions,g)
    elseif j=='cor'then 
      table.insert(a[l].buildoptions,d)
    elseif j=='leg'then
      table.insert(a[l].buildoptions,e)
      table.insert(a[l].buildoptions,f)
      table.insert(a[l].buildoptions,h)
    end 
  end 
end
